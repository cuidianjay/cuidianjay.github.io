---
title: Redis6.0新特性
date: 2021-4-13 15:52:07 +0800
categories: [分布式, Redis]
tags: [分布式, Redis, 缓存设计]
math: true
image: 
---

### 缓存穿透

查询一个根本不存在的数据，缓存层和存储层都没有这个数据，通常情况下，存储层查不到数据不会放入缓存层。

缓存穿透会造成每次请求不存在的数据都需要到存储层查询，起不到缓存层保护存储层的作用。

#### 原因

1. 自身业务代码或者数据有问题；
2. 恶意攻击造成大量空命中。

#### 解决

1. 缓存空值，并给空值的key设置一个过期时间。

2. 布隆过滤器

   对于恶意攻击，向服务器请求大量不存在的数据造成缓存穿透，可以先使用布隆过滤器过滤一次，过滤掉不存在的数据，不让请求往后端发送。

   当布隆过滤器说一个key存在时，这个key可能不存在；当说这个key不存在时，key一定不存在。

   适用于数据命中不高，数据相对固定，实时性低，数据集较大的场景，这种方法占用缓存空间较小，但代码维护复杂。

   > 需要将使用布隆过滤器的数据提前放入布隆过滤器，有新增数据时，也需要放入布隆过滤器。
   >
   > 布隆过滤器不能删除数据，需要删除数据时，需要重新初始化数据。



### 缓存失效（击穿）

当大批量的缓存数据在同一时间失效导致大量请求同时穿透缓存层到达数据库，可能会造成数据库瞬间压力过大甚至直接挂掉。

#### 场景

电商秒杀，将商品在指定时间上架，一般都会将商品放在缓存中，并设定相同的过期时间，当这批商品缓存同时失效时，大量请求就会击穿缓存直接打到数据库。

#### 解决

设置key缓存过期时间时，设定一个时间范围内的随机时间。

### 缓存雪崩







### 热点缓存key重建优化

